"use strict";const o=require("electron"),s=require("path");o.app.name="AnimeWeek";let e=null;const a={"orange-flame":"orange.png","sakura-pink":"pink.png","ocean-blue":"ocean.png","cream-elegance":"cream.png","royal-purple":"purple.png","sunset-gold":"gold.png"};function l(){const c=process.env.VITE_DEV_SERVER_URL?s.join(__dirname,"../src/image",a["orange-flame"]):s.join(process.resourcesPath,"image",a["orange-flame"]);console.log("Loading default icon from:",c);const n=o.nativeImage.createFromPath(c);n.isEmpty()?console.error("Failed to load icon from:",c):console.log("Icon loaded successfully!"),e=new o.BrowserWindow({width:1400,height:900,minWidth:1200,minHeight:700,icon:n,webPreferences:{nodeIntegration:!0,contextIsolation:!1},backgroundColor:"#1A1A1A",title:"AnimeWeek",titleBarStyle:"hiddenInset",show:!1}),process.env.VITE_DEV_SERVER_URL?(e.loadURL(process.env.VITE_DEV_SERVER_URL),e.webContents.openDevTools()):e.loadFile(s.join(__dirname,"../dist/index.html")),e.once("ready-to-show",()=>{e==null||e.show(),e==null||e.setTitle("AnimeWeek")}),e.on("closed",()=>{e=null})}o.app.whenReady().then(()=>{l(),o.ipcMain.on("change-icon",(c,n)=>{if(console.log("Received change-icon request for theme:",n),e&&a[n]){const i=process.env.VITE_DEV_SERVER_URL?s.join(__dirname,"../src/image",a[n]):s.join(process.resourcesPath,"image",a[n]);console.log("Loading theme icon from:",i);const r=o.nativeImage.createFromPath(i);r.isEmpty()?console.error("Failed to load icon from:",i):(console.log("Theme icon loaded successfully!"),e.setIcon(r),process.platform==="darwin"&&o.app.dock.setIcon(r))}else console.error("Invalid theme ID or no main window:",n)}),o.app.on("activate",()=>{o.BrowserWindow.getAllWindows().length===0&&l()})});o.app.on("window-all-closed",()=>{process.platform!=="darwin"&&o.app.quit()});
